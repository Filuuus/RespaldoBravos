<div class="modal fade" id="upload-modal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"> {# Changed to modal-xl for more width #}
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="uploadModalLabel">Upload New File</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="upload-form" data-upload-url="{{ url_for('upload_route') }}">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="file-name" class="form-label">File Name (Optional)</label>
                                <input type="text" class="form-control" id="file-name" name="custom_title" placeholder="Leave blank to use original name">
                            </div>

                            <div class="row">
                                <div class="col-sm-6 mb-3">
                                    <label for="uploadModalPeriodoInicio" class="form-label">Start Period (Optional)</label>
                                    <input type="date" class="form-control" name="periodo_inicio" id="uploadModalPeriodoInicio">
                                </div>
                                <div class="col-sm-6 mb-3">
                                    <label for="uploadModalPeriodoFin" class="form-label">End Period (Optional)</label>
                                    <input type="date" class="form-control" name="periodo_fin" id="uploadModalPeriodoFin">
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="category-select-upload" class="form-label">Category (Optional)</label>
                                <select id="category-select-upload" name="categoria" class="form-select">
                                    <option value="">-- Select Category --</option>
                                    {# Options populated by JavaScript #}
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="destination-folder-select-upload" class="form-label">Destination Folder</label>
                                <select id="destination-folder-select-upload" name="carpeta" class="form-select">
                                    <option value="">-- My Files (Root) --</option>
                                    {# Options populated by JavaScript #}
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="modal-descripcion-upload" class="form-label">Description (Optional)</label>
                                <textarea class="form-control" name="descripcion" id="modal-descripcion-upload" rows="3"></textarea>
                            </div>

                            <div class="form-check mb-3">
                                <input type="checkbox" class="form-check-input" name="favorito" id="modal-favorito-upload" value="true">
                                <label class="form-check-label" for="modal-favorito-upload">Mark as Favorite</label>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="file-upload-area sticky-top"> {# sticky-top might help if left column scrolls #}
                                <label class="form-label">File*</label>
                                <input type="file" id="file-input" name="file" hidden required>
                                <div id="drop-area" class="drop-area">
                                    <div id="drag-text" class="drag-text">
                                        <span id="drag-icon" class="drag-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#6c757d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                <polyline points="17 8 12 3 7 8"></polyline>
                                                <line x1="12" y1="3" x2="12" y2="15"></line>
                                            </svg>
                                        </span>
                                        <p>Drag your file here or</p>
                                        <button type="button" id="upload-button" class="btn btn-outline-primary btn-sm">Select file</button>
                                    </div>
                                    <div id="preview-container" class="preview-container" style="display: none;">
                                        <img id="preview-image" class="preview-image">
                                        <div class="preview-info">
                                            <p id="preview-name" class="preview-name"></p>
                                            <p id="preview-type" class="preview-type"></p>
                                            <p id="preview-size" class="preview-size"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="cancel-upload-button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" id="submit-upload-button" class="btn btn-success">Upload File</button>
                </div>
            </form>
        </div>
    </div>
</div>
